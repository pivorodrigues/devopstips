# <img src="images/gnu-linux.png" width="30px"> Linux Network Administration <img src="images/gnu-linux.png" width="30px">

## Capacity Planning

- **Commands:**

- _iostat_

  - It shows disk IO statistics

  - _apt install sysstat_

  - Use: `$ iostat`

    - Example:

    ```
      $ iostat
      Linux 4.15.0-1051-aws (ip-172-31-92-39) 	11/25/19 	_x86_64_	(1 CPU)

      avg-cpu:  %user   %nice %system %iowait  %steal   %idle
                 2.47    0.01    0.91    0.64    0.70   95.28

      Device             tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn
      loop0             7.83         8.48         0.00      12638          0
      loop1             2.29         2.49         0.00       3716          0
      xvda             10.24       219.48       170.96     326979     254688
    ```

    - Good practices:

      - `$ watch -n1 iostat` _Watch the command results in realtime (1 second difference)_

#

  - _netstat_

    - It shows network statistics

      - Options:

        - `-n` - statistics without resolve hostnames

        - `-t` - only stablished TCP connections

        - `-u` - only stablished UDP connections

        - `-at` - all TCP connections

        - `-ut` - all UDP connections

      - Good practices:

        - `$ netstat -nat` _It shows all TCP connections without resolve hostnames_

          ```
            $ netstat -nat
            Active Internet connections (servers and established)
            Proto Recv-Q Send-Q Local Address           Foreign Address         State
            tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN
            tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN
            tcp        0    316 172.31.92.39:22         186.192.87.1:10766      ESTABLISHED
            tcp6       0      0 :::22                   :::*                    LISTEN
          ```

        - `$ sudo netstat -natp` _It shows all TCP connections without resolve hostnames and the process PID numbers_

          ```
            $ sudo netstat -natp
            Active Internet connections (servers and established)
            Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
            tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      651/systemd-resolve
            tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1027/sshd
            tcp        0    340 172.31.92.39:22         186.192.87.1:20214      ESTABLISHED 14550/sshd: ubuntu
            tcp        0      0 172.31.92.39:22         186.192.87.1:10766      ESTABLISHED 1570/sshd: ubuntu [
            tcp6       0      0 :::22                   :::*                    LISTEN      1027/sshd
          ```  

#

- _w_

  - It shows connected users

  - Use: `$ w`

    - Example:

      ```
        $ w
        21:14:54 up 18 min,  1 user,  load average: 0.00, 0.03, 0.06
        USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
        ubuntu   pts/0    186.192.87.1     21:11    0.00s  0.03s  0.00s w
      ```

    - Good practices:

      - `$ w -h` - It prints with no header

      ```
        $ w -h
        ubuntu   pts/0    186.192.87.1     21:11    3.00s  0.03s  0.00s w -h
      ```

#

      
